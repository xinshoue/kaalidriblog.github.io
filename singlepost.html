<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,300;1,400;1,500;1,600;1,700;1,800&display=swap"
        rel="stylesheet">
    <!-- Slick CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css"
        integrity="sha512-yHknP1/AwR+yx26cB1y0cjvQUMvEa2PFzt1c9LlS4pRQ5NOTZFWbhBig+X9G9eYW/8m0/4OXNx8pxJ6z57x0dw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" type="text/css" href="https://projectperlman.github.io/projectperlman/blog-template/assets/css/public.css">
    <link rel="stylesheet" type="text/css" href="https://projectperlman.github.io/projectperlman/blog-template/assets/css/admin-style.css">
        
     <link rel="stylesheet" href="assets/css/style.css">
     <link rel="stylesheet" href="assets/css/public.css">
     <link rel="stylesheet" href="assets/css/logo-style.css">
     <link rel="stylesheet" href="assets/css/imp-footer.css">
     
    
</head>

<body>
    <header>
        <div class="nav-overlay"></div>
        <span role="button" class="menu-icon">
            <ion-icon name="menu-outline"></ion-icon>
        </span>
        <a href="index.html" class="logo-wrapper td-none">
            <div><span>Kaalidriâ„¢</span></div>
        </a> 

        <nav>
            <div class="search-item">
                <span class="search-icon" role="button">
                    <ion-icon name="search-outline"></ion-icon>
                </span>
                <form action="search.html" method="get" class="header-search-form hide">
                    <input type="search" name="q" placeholder="Search..."
                        class="input-control input-control-sm search-input">
                </form>
            </div>
            
            
            
            <ul class="nav-menu">
                
                
                
  
  
  
   
  
  
  <li class="nav-item"><a href="index.html">Home</a></li>
  
                <li class="nav-item"><a href="browse/index.html">Browse</a></li>
                
                <li class="nav-item"><a href="contact_form/contact_us.html">Contact Us</a></li>
                <li class="nav-item"><a href="index.html">Popular</a></li>
                
                
                 
                 
                
               <li class="nav-item"><a href="login.html">New user</a></li>
               <li class="nav-item"><a href="about/about_us.html">About</a></li>
        </nav>
    </header>

    <!-- Page Banner -->
    <section class="page-banner">
        <div class="banner-container">
            <div class="left-box">
                <div class="breadcrumbs" id="breadcrumbs"></div>
                <h1 class="banner-title" id="post-title"></h1>
                <div class="post-details">
                    <div class="author-wrapper">
                        <img class="avatar" id="author-avatar" src="assets/images/avatar/avatar.jpg" alt="">
                        <div class="name-wrapper">
                            <a href="author.html" class="link" id="author-name"></a>
                            <small class="gray-1" id="post-date"></small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="right-box">
                <div class="bg-image featured-image-wrapper" id="featured-image"></div>
            </div>
        </div>
        
        
        
      
        
        
        
    </section>

    <!-- Page Container -->
    <div class="default-page-container page-container single-page">
        <div class="main-content">
            <div class="primary-font" id="post-content">
                <!-- Post content will load dynamically via post.js -->
            </div>
        </div>
        
           
                
            </div>
            
            </div>
        
    </div>
    
    
<div id="more-from-kaalidri" class="more-posts-section">
  <h3>More from <a href="https://kaalidri.xyz"><span>kaalidri.xyz</span></a></h3>
  <div class="more-posts-list">
    <!-- Your JS will auto-fill posts here -->
  </div>
</div>

    <!-- Footer -->
     <!-- Page Footer -->
    <footer class="page-footer">
        <div class="footer-content">
            <div class="content-section company-info">
                <h3 class="section-title"><a href="about/about_us.html" class="link">About</h3>
                
                <div class="social-links">
                    
                    <a href="#">
                        <ion-icon name="logo-instagram" class="social-icon"></ion-icon>
                    </a>
                    
                    
                    
                </div>
            </div>
            <div class="content-section helpful-links">
                <div>
                    <h3 class="section-title">Helpful Links</h3>
                    <ul>
                        
                        <li><a href="terms/terms_and_conditions.html" class="link">Terms and Conditions</a></li>
                    </ul>
                </div>
            </div>
            <div class="content-section contact-wrapper">
                <h3 class="section-title"><a href="Contact_form/contact_us.html" class="link">Contact Us</h3>
                </a>
            </div>
        </div>
        
        <div class="copyright-info">
            <p class="center">Copyright &copy; 2025 Kaalidri</p>
        </div>
    </footer>
    <!-- End of Page Footer -->

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"
        integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"
        integrity="sha512-XtmMtDEcNz2j7ekrtHvOVR4iwwaD6o/FUJe6+Zq+HgcCsk3kj4uSQQR8weQ2QVj1o0Pk6PwYLohm206ZzNfubg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

    <script src="post.js"></script>

    <script>
        // Toggle Search input
        const mobileBreakPoint = 754;
        const searchIcon = document.querySelector('.search-icon');
        const headerSearchForm = document.querySelector('.header-search-form');
        const searchInput = document.querySelector('.search-input');
        const logoWrapper = document.querySelector('.logo-wrapper');

        function toggleSearchBar() {
            searchIcon.classList.toggle('hide');
            headerSearchForm.classList.toggle('hide');
            searchInput.focus();
            if (window.innerWidth == mobileBreakPoint) {
                logoWrapper.classList.toggle('hide');
            }
        }
        searchIcon.addEventListener('click', toggleSearchBar);
        searchInput.addEventListener('blur', toggleSearchBar);

        // Navbar Responsiveness
        const menuIcon = document.querySelector('.menu-icon');
        const navOverlay = document.querySelector('.nav-overlay');
        const navMenu = document.querySelector('.nav-menu');
        const dropdowns = document.querySelectorAll('.nav-item .dropdown');

        menuIcon.addEventListener('click', function () {
            navOverlay.classList.toggle('open');
            navMenu.classList.toggle('open');
        });

        navOverlay.addEventListener('click', function () {
            navOverlay.classList.remove('open');
            navMenu.classList.remove('open');
        });

        // Dropdown Section
        dropdowns.forEach(dropdown => {
            const navItem = dropdown.closest('.nav-item');
            navItem.addEventListener('click', function () {
                navItem.classList.toggle('active');
            })
        })

        // Slick Carousel
        $('.post-slider').each(function (index, slider) {
            $(slider).slick({
                slidesToShow: 3,
                slidesToScroll: 1,
                autoplay: false,
                infinite: false,
                autoplaySpeed: 2000,
                nextArrow: $(slider).siblings('.next-arrow'),
                prevArrow: $(slider).siblings('.prev-arrow'),
                responsive: [
                    {
                        breakpoint: 1024,
                        settings: {
                            slidesToShow: 2,
                        }
                    },
                    {
                        breakpoint: 550,
                        settings: {
                            slidesToShow: 1,
                        }
                    }
                ]
            });
        });
    </script>
    <script>
const CONFIG = {
  files: [
    { url: 'posts.json', source: 'posts', linkPage: 'singlepost.html' },
    { url: 'posts2.json', source: 'posts2', linkPage: 'singlepost2.html' }
  ],
  localStorageKey: 'user_profile_v1',
  limit: 4,  // how many suggestions
  explorationRate: 0.25
};

// --- Profile ---
function loadProfile() {
  try { return JSON.parse(localStorage.getItem(CONFIG.localStorageKey)) || {weights:{}}; }
  catch { return {weights:{}}; }
}
function saveProfile(p) { localStorage.setItem(CONFIG.localStorageKey, JSON.stringify(p)); }
function updateProfile(post) {
  const p = loadProfile();
  const cat = getCategory(post);
  p.weights[cat] = (p.weights[cat]||0)+3;
  tokenize(post.title).forEach(k=> p.weights[k]=(p.weights[k]||0)+1 );
  saveProfile(p);
}

// --- Utils ---
async function fetchFile(url,source) {
  try { 
    const r=await fetch(url);
    if(!r.ok) return [];
    return (await r.json()).map(p=>({...p,source}));
  } catch { return []; }
}
function getCategory(post){
  if(!post.breadcrumbs) return 'General';
  const txt = post.breadcrumbs.replace(/<[^>]+>/g,'').toLowerCase();
  if(txt.includes('movie')) return 'Movies';
  if(txt.includes('book')) return 'Books';
  if(txt.includes('series')) return 'Series';
  if(txt.includes('anime')) return 'Anime';
  return 'General';
}
function tokenize(txt){
  return (txt||'').toLowerCase().split(/\W+/).filter(w=>w.length>2);
}
function scorePost(post,profile){
  let s=0;
  const cat=getCategory(post);
  s+=(profile.weights[cat]||0)*3;
  tokenize(post.title).forEach(k=> s+=profile.weights[k]||0 );
  return s+Math.random()*0.01;
}
function pickSuggestions(posts,currentId,profile){
  const scored=posts.filter(p=>p.id!==currentId).map(p=>({p,s:scorePost(p,profile)}));
  scored.sort((a,b)=>b.s-a.s);
  const familiarCount=Math.round(CONFIG.limit*(1-CONFIG.explorationRate));
  const familiar=scored.slice(0,familiarCount).map(x=>x.p);
  const remaining=posts.filter(p=>!familiar.includes(p)&&p.id!==currentId);
  const exploratory=remaining.sort(()=>Math.random()-0.5).slice(0,CONFIG.limit-familiar.length);
  return [...familiar,...exploratory];
}

// --- Render ---
function renderMore(posts){
  const c=document.querySelector('#more-from-kaalidri .more-posts-list');
  c.innerHTML='';
  posts.forEach(post=>{
    const linkPage=post.source==='posts'?'singlepost.html':'singlepost2.html';
    const div=document.createElement('div');
    div.className='more-post';
    div.innerHTML=`
      <a href="${linkPage}?id=${post.id}">
        <img src="${post.featuredImage||'assets/images/featured_image/default.png'}" alt="${post.title}">
        <div class="info">
          <h4>${post.title}</h4>
          <p>${(post.content||'').replace(/<[^>]+>/g,'').slice(0,80)}...</p>
        </div>
      </a>`;
    c.appendChild(div);
  });
}

// --- Init ---
(async()=>{
  const params=new URLSearchParams(location.search);
  const id=params.get('id');
  if(!id) return;
  const [a,b]=await Promise.all(CONFIG.files.map(f=>fetchFile(f.url,f.source)));
  const posts=[...a,...b];
  const current=posts.find(p=>p.id===id);
  if(current) updateProfile(current);
  const profile=loadProfile();
  const recs=pickSuggestions(posts,id,profile);
  renderMore(recs);
})();
</script>
  
  
</body>

</html>
