<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Perlman </title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,300;1,400;1,500;1,600;1,700;1,800&display=swap"
        rel="stylesheet">

    <!-- Slick CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- External CSS files -->
    <link rel="stylesheet" type="text/css" href="https://projectperlman.github.io/projectperlman/blog-template/assets/css/public.css">
    <link rel="stylesheet" type="text/css" href="https://projectperlman.github.io/projectperlman/blog-template/assets/css/admin-style.css">
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/public.css">
    <link rel="stylesheet" href="../assets/css/logo-style.css">
    <link rel="stylesheet" href="../assets/css/browse-list.css">

    <!-- Extracted torrent browser styles -->
    
      
    
</head>

<body>
    <body>
    <header>
        <div class="nav-overlay"></div>
        <span role="button" class="menu-icon">
            <ion-icon name="menu-outline"></ion-icon>
        </span>
        <a href="index.html" class="logo-wrapper td-none">
            <div><span>Kaalidri™</span></div>
        </a> 

        <nav>
            <div class="search-item">
                <span class="search-icon" role="button">
                    <ion-icon name="search-outline"></ion-icon>
                </span>
                <form action="../search.html" method="get" class="header-search-form hide">
                    <input type="search" name="q" placeholder="Search..."
                        class="input-control input-control-sm search-input">
                </form>
            </div>
            
            
            <ul class="nav-menu">
                
                
                
  
  
  
   
  <li class="nav-item"><a href="../index.html">Home</a></li>
  
  
  
                <li class="nav-item"><a href="../browse/index.html">Browse</a></li>
                
               <li class="nav-item"><a href="../contact_form/contact_us.html">Contact Us</a></li>
                <li class="nav-item"><a href="../index.html">Popular</a></li>
                
                
                 
                 
                
               <li class="nav-item"><a href="../login.html">login</a></li>
               <li class="nav-item"><a href="../about/about_us.html">About</a></li>
        </nav>
    </header>

    <!-- Torrent Browser Content -->
    <div class="torrent-browser">
        <div class="torrent-header">
            <h1>Browse</h1>
            <p id="total-count">(0)</p>
        </div>

        <div class="torrent-nav">
<div class="torrent-nav-item" data-type="Article">Articles</div>
            <div class="torrent-nav-item active" data-type="Movie">Movies</div>
            <div class="torrent-nav-item" data-type="TV">TV</div>
            <div class="torrent-nav-item" data-type="Game">Games</div>
            <div class="torrent-nav-item" data-type="Anime">Anime</div>
            <div class="torrent-nav-item" data-type="Mini Series">Mini Series</div>
            <div class="torrent-nav-item" data-type="Education">Education</div>
            <div class="torrent-nav-item" data-type="Other">Other</div>
        </div>

        <select class="mobile-category-select" id="mobile-type-select">
            <option value="Movie">Movies</option>
            <option value="TV">TV</option>
<option value="Article">Articles</option>
            <option value="Game">Games</option>
            <option value="Anime">Anime</option>
            <option value="Mini Series">Mini Series</option>
            <option value="Education">Education</option>
            <option value="Other">Other</option>
        </select>

        <div id="results-panel" class="results-panel hidden">
            <div class="results-title" id="results-title"></div>
            <div id="results"></div>
        </div>

        <div class="torrent-categories">
            <!-- Categories will be loaded by JavaScript -->
        </div>
    </div>

    <!-- Page Footer -->
    <footer class="page-footer">
        <div class="footer-content">
            <div class="content-section company-info">
                <h3 class="section-title"><a href="../about/about_us.html" class="link">About</a></h3>
                <div class="social-links">
                    <a href="#"><ion-icon name="logo-instagram" class="social-icon"></ion-icon></a>
                </div>
            </div>
            <div class="content-section helpful-links">
                <div>
                    <h3 class="section-title">Helpful Links</h3>
                    <ul>
                        <li><a href="../terms/terms_and_conditions.html" class="link">Terms and Conditions</a></li>
                    </ul>
                </div>
            </div>
            <div class="content-section contact-wrapper">
                <h3 class="section-title"><a href="../contact_form/contact_us.html" class="link">Contact Us</a></h3>
            </div>
        </div>
        
        <div class="copyright-info">
            <p class="center">Copyright &copy; 2025 Kaalidri</p>
        </div>
    </footer>

    <!-- Jquery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <!-- Slick JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
    <!-- Ionicons -->
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

    <!-- Custom Script -->
    <script>
        // Globals
        let allItems = [];
        let currentType = 'Movie'; // default

        function groupCounts(items, key) {
            const counts = {};
            items.forEach(it => {
                const k = it[key];
                if (!k) return;
                counts[k] = (counts[k] || 0) + 1;
            });
            // sort keys alphabetically/numerically
            const ordered = {};
            Object.keys(counts).sort((a, b) => {
                // if both look like years, sort desc
                const na = Number(a), nb = Number(b);
                if (!isNaN(na) && !isNaN(nb)) return nb - na;
                return a.localeCompare(b);
            }).forEach(k => ordered[k] = counts[k]);
            return ordered;
        }

        function buildSection(container, title, counts, paramKey) {
            if (!counts || Object.keys(counts).length === 0) return;

            const section = document.createElement('div');
            section.className = 'category-section';

            const header = document.createElement('div');
            header.className = 'category-header';
            const h3 = document.createElement('h3');
            h3.className = 'category-title';
            h3.textContent = title;
            header.appendChild(h3);
            section.appendChild(header);

            const content = document.createElement('div');
            content.className = 'category-content';

            Object.entries(counts).forEach(([key, count]) => {
                const item = document.createElement('div');
                item.className = 'category-item';

                const link = document.createElement('a');
                link.className = 'item-name';
                link.href = '#';
                link.textContent = key;
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    showResults(paramKey, key);
                });

                const countEl = document.createElement('span');
                countEl.className = 'item-count';
                countEl.textContent = count;

                item.appendChild(link);
                item.appendChild(countEl);
                content.appendChild(item);
            });

            section.appendChild(content);
            container.appendChild(section);
        }

        function renderCategories() {
            const container = document.querySelector('.torrent-categories');
            container.innerHTML = '';

            const filtered = allItems.filter(it => it.type === currentType);
            document.getElementById('total-count').textContent = `(${filtered.length})`;

            const byCategory = groupCounts(filtered, 'category');
            const byGenre = groupCounts(filtered, 'genre');
            const byYear = groupCounts(filtered, 'year');
            const byReleaseType = groupCounts(filtered, 'releaseType');
            const byCodec = groupCounts(filtered, 'codec');
            const byResolution = groupCounts(filtered, 'resolution');
            const bySize = groupCounts(filtered, 'size');

            buildSection(container, 'BY CATEGORY', byCategory, 'category');
            buildSection(container, 'BY GENRE', byGenre, 'genre');
            buildSection(container, 'BY YEAR', byYear, 'year');
            buildSection(container, 'BY RELEASE TYPE', byReleaseType, 'releaseType');
            buildSection(container, 'BY CODEC', byCodec, 'codec');
            buildSection(container, 'BY RESOLUTION', byResolution, 'resolution');
            buildSection(container, 'BY SIZE', bySize, 'size');
        }

        function showResults(groupKey, value) {
            const filtered = allItems.filter(it => it.type === currentType && it[groupKey] === value);
            const resultsPanel = document.getElementById('results-panel');
            const title = document.getElementById('results-title');
            const results = document.getElementById('results');

            title.textContent = `${currentType}: ${groupKey.replace(/([A-Z])/g,' $1').toUpperCase()} → ${value} (${filtered.length})`;
            results.innerHTML = filtered.map(it => {
    const meta = [it.genre, it.year, it.resolution, it.codec].filter(Boolean).join(' • ');
    const title = it.url 
        ? `<a href="${it.url}" class="result-link">${it.title}</a>` 
        : it.title;
    return `<div class="result-item">
        <div>${title}</div>
        <div class="result-meta">${meta}</div>
    </div>`;
}).join('') || '<div class="result-item">No items found.</div>';

            resultsPanel.classList.remove('hidden');
            // scroll to results
            resultsPanel.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function setupTypeSwitching() {
            const navItems = document.querySelectorAll('.torrent-nav-item');
            navItems.forEach(el => {
                el.addEventListener('click', () => {
                    navItems.forEach(n => n.classList.remove('active'));
                    el.classList.add('active');
                    currentType = el.getAttribute('data-type') || 'Movie';
                    document.getElementById('mobile-type-select').value = currentType;
                    // hide results when switching type
                    document.getElementById('results-panel').classList.add('hidden');
                    renderCategories();
                });
            });

            const mobileSelect = document.getElementById('mobile-type-select');
            mobileSelect.addEventListener('change', (e) => {
                currentType = e.target.value;
                // sync desktop nav highlight
                document.querySelectorAll('.torrent-nav-item').forEach(n => {
                    if ((n.getAttribute('data-type') || '') === currentType) n.classList.add('active');
                    else n.classList.remove('active');
                });
                document.getElementById('results-panel').classList.add('hidden');
                renderCategories();
            });
        }

        async function loadData() {
            const response = await fetch("categories.json");
            const data = await response.json();

            if (Array.isArray(data.items)) {
                allItems = data.items;
            } else {
                allItems = [];
            }

            setupTypeSwitching();
            renderCategories();
        }

        document.addEventListener('DOMContentLoaded', loadData);
    </script>
    <script>
        // Navbar Responsiveness
        const menuIcon = document.querySelector('.menu-icon');
        const navOverlay = document.querySelector('.nav-overlay');
        const navMenu = document.querySelector('.nav-menu');
        const dropdowns = document.querySelectorAll('.nav-item .dropdown');

        menuIcon.addEventListener('click', function () {
            navOverlay.classList.toggle('open');
            navMenu.classList.toggle('open');
        });

        navOverlay.addEventListener('click', function () {
            navOverlay.classList.remove('open');
            navMenu.classList.remove('open');
        });

        // Dropdown Section
        dropdowns.forEach(dropdown => {
            const navItem = dropdown.closest('.nav-item');
            navItem.addEventListener('click', function () {
                navItem.classList.toggle('active');
            })
        })

        // Slick Carousel
        $('.post-slider').each(function (index, slider) {
            $(slider).slick({
                slidesToShow: 3,
                slidesToScroll: 1,
                autoplay: false,
                infinite: false,
                autoplaySpeed: 2000,
                nextArrow: $(slider).siblings('.next-arrow'),
                prevArrow: $(slider).siblings('.prev-arrow'),
                responsive: [
                    {
                        breakpoint: 1024,
                        settings: {
                            slidesToShow: 2,
                        }
                    },
                    {
                        breakpoint: 550,
                        settings: {
                            slidesToShow: 1,
                        }
                    }
                ]
            });
        });
    </script>
    <script>
        // Toggle Search input
        const mobileBreakPoint = 754;
        const searchIcon = document.querySelector('.search-icon');
        const headerSearchForm = document.querySelector('.header-search-form');
        const searchInput = document.querySelector('.search-input');
        const logoWrapper = document.querySelector('.logo-wrapper');

        function toggleSearchBar() {
            searchIcon.classList.toggle('hide');
            headerSearchForm.classList.toggle('hide');
            searchInput.focus();
            if (window.innerWidth == mobileBreakPoint) {
                logoWrapper.classList.toggle('hide');
            }
        }
        searchIcon.addEventListener('click', toggleSearchBar);
        searchInput.addEventListener('blur', toggleSearchBar);
        </script>
</body>
</html>
